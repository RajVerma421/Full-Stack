<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Simple Calculator</title>
  <style>
    :root{
      --bg:#0f1724;
      --panel:#0b1220;
      --accent:#7c3aed;
      --btn:#111827;
      --btn-light:#1f2937;
      --text:#e6eef8;
      --muted:#9aa6bd;
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }

    *{box-sizing:border-box}
    html,body{height:100%;}
    body{
      margin:0;
      background: radial-gradient(1200px 600px at 10% 10%, rgba(124,58,237,0.08), transparent),
                  linear-gradient(180deg, #061025 0%, #071226 100%);
      display:flex;align-items:center;justify-content:center;
      color:var(--text);
      padding:24px;
    }

    .calculator{
      width:340px;
      background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));
      border-radius:16px;
      padding:18px;
      box-shadow: 0 10px 30px rgba(2,6,23,0.6), inset 0 1px 0 rgba(255,255,255,0.02);
      border:1px solid rgba(255,255,255,0.03);
    }

    .screen{
      height:78px;
      background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
      border-radius:10px;
      padding:12px;
      display:flex;flex-direction:column;justify-content:center;align-items:flex-end;
      margin-bottom:12px;
      overflow:hidden;
    }

    .expr{
      font-size:14px;color:var(--muted);width:100%;text-align:right;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;
    }
    .display{
      font-size:28px;line-height:1;width:100%;text-align:right;font-weight:600;letter-spacing:0.5px;
    }

    .keys{
      display:grid;
      grid-template-columns: repeat(4, 1fr);
      gap:10px;
    }

    button{
      height:52px;border-radius:10px;border:0;cursor:pointer;font-size:18px;font-weight:600;
      background:var(--btn);color:var(--text);box-shadow: 0 4px 10px rgba(2,6,23,0.6);
      transition:transform .06s ease, box-shadow .06s ease, background .12s ease;
    }
    button:active{transform:translateY(1px)}
    .btn-light{background:var(--btn-light);font-weight:600}
    .btn-accent{background:linear-gradient(180deg,var(--accent),#5b21b6);box-shadow:0 8px 20px rgba(124,58,237,0.18)}
    .span-2{grid-column: span 2;}

    /* responsive */
    @media (max-width:380px){
      .calculator{width:94vw}
      .display{font-size:24px}
      button{height:48px;font-size:16px}
    }
  </style>
</head>
<body>
  <main class="calculator" role="application" aria-label="Calculator">
    <section class="screen" aria-live="polite">
      <div id="expr" class="expr">&nbsp;</div>
      <div id="display" class="display">0</div>
    </section>

    <section class="keys" role="group" aria-label="Calculator buttons">
      <button id="clear" class="btn-light">C</button>
      <button id="back" class="btn-light">←</button>
      <button data-op="%" class="btn-light">%</button>
      <button data-op="/" class="btn-light">÷</button>

      <button data-num="7">7</button>
      <button data-num="8">8</button>
      <button data-num="9">9</button>
      <button data-op="*" class="btn-light">×</button>

      <button data-num="4">4</button>
      <button data-num="5">5</button>
      <button data-num="6">6</button>
      <button data-op="-" class="btn-light">−</button>

      <button data-num="1">1</button>
      <button data-num="2">2</button>
      <button data-num="3">3</button>
      <button data-op="+" class="btn-light">+</button>

      <button data-num="0" class="span-2">0</button>
      <button data-num="." class="btn-light">.</button>
      <button id="equals" class="btn-accent">=</button>
    </section>
  </main>

  <script>
    (function(){
      const displayEl = document.getElementById('display');
      const exprEl = document.getElementById('expr');
      let current = '0';
      let expression = '';

      function update(){
        displayEl.textContent = current;
        exprEl.textContent = expression || '\u00A0';
      }

      function pushDigit(d){
        if(current === '0' && d !== '.') current = d;
        else if(current.includes('.') && d === '.') return;
        else current += d;
        update();
      }

      function pushOperator(op){
        if(expression === '' && current === '0' && op === '-'){
          current = '-'; update(); return;
        }
        // finalize current into expression
        if(expression && /[+\-*/%]$/.test(expression) && current === ''){
          // replace last operator
          expression = expression.slice(0,-1) + op;
        } else {
          expression = (expression || '') + (current || '0') + op;
        }
        current = '';
        update();
      }

      function clearAll(){ current = '0'; expression = ''; update(); }
      function backspace(){
        if(current.length>0){ current = current.slice(0,-1) || '0'; }
        else if(expression.length>0){ expression = expression.slice(0,-1); }
        update();
      }

      function calculate(){
        try{
          // build final string
          let expr = (expression || '') + (current || '0');
          // sanitize: allow only digits, operators, dot, percent
          if(!/^[0-9.+\-*/()%\s]+$/.test(expr)) throw new Error('Invalid');
          // handle percent: replace 'number%' with '(number/100)'
          expr = expr.replace(/(\d+(?:\.\d+)?)%/g, '($1/100)');
          // evaluate using Function (safer than eval in small app)
          const result = Function('return ' + expr)();
          current = String(Number.isFinite(result) ? +result : '0');
          expression = '';
          update();
        }catch(e){
          current = 'Error'; expression = '';
          update();
          setTimeout(()=>{ clearAll(); }, 1200);
        }
      }

      document.querySelectorAll('[data-num]').forEach(b=>{
        b.addEventListener('click', ()=>{
          pushDigit(b.getAttribute('data-num'));
        });
      });

      document.querySelectorAll('[data-op]').forEach(b=>{
        b.addEventListener('click', ()=>{
          pushOperator(b.getAttribute('data-op'));
        });
      });

      document.getElementById('clear').addEventListener('click', clearAll);
      document.getElementById('back').addEventListener('click', backspace);
      document.getElementById('equals').addEventListener('click', calculate);

      // keyboard support
      window.addEventListener('keydown', (e)=>{
        if(e.key >= '0' && e.key <= '9') pushDigit(e.key);
        else if(e.key === '.') pushDigit('.');
        else if(e.key === 'Enter' || e.key === '=') { e.preventDefault(); calculate(); }
        else if(e.key === 'Backspace') backspace();
        else if(e.key === 'Escape') clearAll();
        else if(['+','-','*','/','%'].includes(e.key)) pushOperator(e.key);
      });

      update();
    })();
  </script>
</body>
</html>
